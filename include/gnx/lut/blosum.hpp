// SPDX-License-Identifier: MIT
// Copyright (c) 2025 Armin Sobhani
//
#pragma once

#include <array>
#include <cstdint>

namespace gnx::lut {

/// @brief Lookup table for amino acid character to matrix index conversion
/// Order: A C D E F G H I K L M N P Q R S T V W Y B Z X *
/// All other characters map to 22 (X - any amino acid)
constexpr std::array<int, 256> aa_index_lut = []() constexpr {
    std::array<int, 256> lut{};
    // Initialize all entries to 22 (X - unknown/any amino acid)
    for (int i = 0; i < 256; ++i)
        lut[i] = 22;

    // Map uppercase amino acids
    lut['A'] = 0;  lut['C'] = 1;  lut['D'] = 2;  lut['E'] = 3;
    lut['F'] = 4;  lut['G'] = 5;  lut['H'] = 6;  lut['I'] = 7;
    lut['K'] = 8;  lut['L'] = 9;  lut['M'] = 10; lut['N'] = 11;
    lut['P'] = 12; lut['Q'] = 13; lut['R'] = 14; lut['S'] = 15;
    lut['T'] = 16; lut['V'] = 17; lut['W'] = 18; lut['Y'] = 19;
    lut['B'] = 20; // Aspartic acid or Asparagine
    lut['Z'] = 21; // Glutamic acid or Glutamine
    lut['X'] = 22; // Any amino acid
    lut['*'] = 23; // Stop codon

    // Map lowercase amino acids
    lut['a'] = 0;  lut['c'] = 1;  lut['d'] = 2;  lut['e'] = 3;
    lut['f'] = 4;  lut['g'] = 5;  lut['h'] = 6;  lut['i'] = 7;
    lut['k'] = 8;  lut['l'] = 9;  lut['m'] = 10; lut['n'] = 11;
    lut['p'] = 12; lut['q'] = 13; lut['r'] = 14; lut['s'] = 15;
    lut['t'] = 16; lut['v'] = 17; lut['w'] = 18; lut['y'] = 19;
    lut['b'] = 20; lut['z'] = 21; lut['x'] = 22;

    return lut;
}();

/// @brief Amino acid index mapping for substitution matrices
/// Maps amino acid characters to matrix indices (0-23)
/// Order: A C D E F G H I K L M N P Q R S T V W Y B Z X *
inline constexpr int aa_to_index(char aa)
{   return aa_index_lut[static_cast<unsigned char>(aa)];
}

/// @brief BLOSUM62 substitution matrix
/// The most commonly used substitution matrix for protein sequence alignment
/// Based on blocks of conserved sequences with ~62% identity
constexpr std::array<std::array<int, 24>, 24> blosum62 = {{
    //A   C   D   E   F   G   H   I   K   L   M   N   P   Q   R   S   T   V   W   Y   B   Z   X   *
    { 4,  0, -2, -1, -2,  0, -2, -1, -1, -1, -1, -2, -1, -1, -1,  1,  0,  0, -3, -2, -2, -1,  0, -4}, // A
    { 0,  9, -3, -4, -2, -3, -3, -1, -3, -1, -1, -3, -3, -3, -3, -1, -1, -1, -2, -2, -3, -3, -2, -4}, // C
    {-2, -3,  6,  2, -3, -1, -1, -3, -1, -4, -3,  1, -1,  0, -2,  0, -1, -3, -4, -3,  4,  1, -1, -4}, // D
    {-1, -4,  2,  5, -3, -2,  0, -3,  1, -3, -2,  0, -1,  2,  0,  0, -1, -2, -3, -2,  1,  4, -1, -4}, // E
    {-2, -2, -3, -3,  6, -3, -1,  0, -3,  0,  0, -3, -4, -3, -3, -2, -2, -1,  1,  3, -3, -3, -1, -4}, // F
    { 0, -3, -1, -2, -3,  6, -2, -4, -2, -4, -3,  0, -2, -2, -2,  0, -2, -3, -2, -3, -1, -2, -1, -4}, // G
    {-2, -3, -1,  0, -1, -2,  8, -3, -1, -3, -2,  1, -2,  0,  0, -1, -2, -3, -2,  2,  0,  0, -1, -4}, // H
    {-1, -1, -3, -3,  0, -4, -3,  4, -3,  2,  1, -3, -3, -3, -3, -2, -1,  3, -3, -1, -3, -3, -1, -4}, // I
    {-1, -3, -1,  1, -3, -2, -1, -3,  5, -2, -1,  0, -1,  1,  2,  0, -1, -2, -3, -2,  0,  1, -1, -4}, // K
    {-1, -1, -4, -3,  0, -4, -3,  2, -2,  4,  2, -3, -3, -2, -2, -2, -1,  1, -2, -1, -4, -3, -1, -4}, // L
    {-1, -1, -3, -2,  0, -3, -2,  1, -1,  2,  5, -2, -2,  0, -1, -1, -1,  1, -1, -1, -3, -1, -1, -4}, // M
    {-2, -3,  1,  0, -3,  0,  1, -3,  0, -3, -2,  6, -2,  0,  0,  1,  0, -3, -4, -2,  3,  0, -1, -4}, // N
    {-1, -3, -1, -1, -4, -2, -2, -3, -1, -3, -2, -2,  7, -1, -2, -1, -1, -2, -4, -3, -2, -1, -2, -4}, // P
    {-1, -3,  0,  2, -3, -2,  0, -3,  1, -2,  0,  0, -1,  5,  1,  0, -1, -2, -2, -1,  0,  3, -1, -4}, // Q
    {-1, -3, -2,  0, -3, -2,  0, -3,  2, -2, -1,  0, -2,  1,  5, -1, -1, -3, -3, -2, -1,  0, -1, -4}, // R
    { 1, -1,  0,  0, -2,  0, -1, -2,  0, -2, -1,  1, -1,  0, -1,  4,  1, -2, -3, -2,  0,  0,  0, -4}, // S
    { 0, -1, -1, -1, -2, -2, -2, -1, -1, -1, -1,  0, -1, -1, -1,  1,  5,  0, -2, -2, -1, -1,  0, -4}, // T
    { 0, -1, -3, -2, -1, -3, -3,  3, -2,  1,  1, -3, -2, -2, -3, -2,  0,  4, -3, -1, -3, -2, -1, -4}, // V
    {-3, -2, -4, -3,  1, -2, -2, -3, -3, -2, -1, -4, -4, -2, -3, -3, -2, -3, 11,  2, -4, -3, -2, -4}, // W
    {-2, -2, -3, -2,  3, -3,  2, -1, -2, -1, -1, -2, -3, -1, -2, -2, -2, -1,  2,  7, -3, -2, -1, -4}, // Y
    {-2, -3,  4,  1, -3, -1,  0, -3,  0, -4, -3,  3, -2,  0, -1,  0, -1, -3, -4, -3,  4,  1, -1, -4}, // B
    {-1, -3,  1,  4, -3, -2,  0, -3,  1, -3, -1,  0, -1,  3,  0,  0, -1, -2, -3, -2,  1,  4, -1, -4}, // Z
    { 0, -2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -2, -1, -1,  0,  0, -1, -2, -1, -1, -1, -1, -4}, // X
    {-4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4,  1}  // *
}};

/// @brief BLOSUM80 substitution matrix
/// More stringent matrix for closely related sequences (>80% identity)
constexpr std::array<std::array<int, 24>, 24> blosum80 = {{
    //A   C   D   E   F   G   H   I   K   L   M   N   P   Q   R   S   T   V   W   Y   B   Z   X   *
    { 5, -1, -2, -1, -3,  0, -2, -2, -1, -2, -2, -2, -1, -1, -2,  1,  0,  0, -3, -2, -2, -1, -1, -6}, // A
    {-1, 12, -4, -5, -3, -4, -4, -2, -3, -2, -2, -3, -4, -4, -4, -2, -1, -1, -3, -3, -4, -4, -2, -6}, // C
    {-2, -4,  7,  2, -4, -2, -1, -4, -1, -5, -4,  1, -2,  0, -3,  0, -1, -4, -5, -4,  5,  1, -2, -6}, // D
    {-1, -5,  2,  6, -4, -3,  0, -4,  1, -4, -3,  0, -2,  2, -1, -1, -1, -3, -4, -3,  1,  5, -1, -6}, // E
    {-3, -3, -4, -4,  8, -4, -1,  0, -4,  0,  0, -4, -5, -4, -4, -3, -3, -1,  1,  4, -4, -4, -2, -6}, // F
    { 0, -4, -2, -3, -4,  7, -3, -5, -3, -5, -4, -1, -3, -3, -3,  0, -2, -4, -3, -4, -1, -3, -2, -6}, // G
    {-2, -4, -1,  0, -1, -3,  9, -4, -1, -4, -3,  1, -3,  1,  0, -1, -2, -4, -3,  2,  0,  0, -1, -6}, // H
    {-2, -2, -4, -4,  0, -5, -4,  5, -4,  2,  2, -4, -4, -4, -4, -3, -1,  3, -4, -2, -4, -4, -2, -6}, // I
    {-1, -3, -1,  1, -4, -3, -1, -4,  6, -3, -2,  0, -1,  2,  3, -1, -1, -3, -4, -2,  0,  1, -1, -6}, // K
    {-2, -2, -5, -4,  0, -5, -4,  2, -3,  5,  3, -4, -4, -2, -3, -4, -2,  1, -3, -2, -4, -3, -2, -6}, // L
    {-2, -2, -4, -3,  0, -4, -3,  2, -2,  3,  7, -3, -3,  0, -2, -2, -1,  1, -2, -1, -4, -2, -1, -6}, // M
    {-2, -3,  1,  0, -4, -1,  1, -4,  0, -4, -3,  7, -3,  0, -1,  1,  0, -4, -5, -3,  4,  0, -1, -6}, // N
    {-1, -4, -2, -2, -5, -3, -3, -4, -1, -4, -3, -3,  9, -2, -3, -1, -2, -4, -5, -4, -3, -2, -2, -6}, // P
    {-1, -4,  0,  2, -4, -3,  1, -4,  2, -2,  0,  0, -2,  7,  1,  0, -1, -3, -3, -2,  0,  4, -1, -6}, // Q
    {-2, -4, -3, -1, -4, -3,  0, -4,  3, -3, -2, -1, -3,  1,  6, -1, -1, -3, -4, -3, -2,  0, -1, -6}, // R
    { 1, -2,  0, -1, -3,  0, -1, -3, -1, -4, -2,  1, -1,  0, -1,  5,  2, -2, -4, -2,  0,  0, -1, -6}, // S
    { 0, -1, -1, -1, -3, -2, -2, -1, -1, -2, -1,  0, -2, -1, -1,  2,  6,  0, -3, -2, -1, -1,  0, -6}, // T
    { 0, -1, -4, -3, -1, -4, -4,  3, -3,  1,  1, -4, -4, -3, -3, -2,  0,  5, -4, -2, -4, -3, -1, -6}, // V
    {-3, -3, -5, -4,  1, -3, -3, -4, -4, -3, -2, -5, -5, -3, -4, -4, -3, -4, 12,  3, -5, -4, -3, -6}, // W
    {-2, -3, -4, -3,  4, -4,  2, -2, -2, -2, -1, -3, -4, -2, -3, -2, -2, -2,  3,  8, -3, -3, -2, -6}, // Y
    {-2, -4,  5,  1, -4, -1,  0, -4,  0, -4, -4,  4, -3,  0, -2,  0, -1, -4, -5, -3,  5,  1, -2, -6}, // B
    {-1, -4,  1,  5, -4, -3,  0, -4,  1, -3, -2,  0, -2,  4,  0,  0, -1, -3, -4, -3,  1,  5, -1, -6}, // Z
    {-1, -2, -2, -1, -2, -2, -1, -2, -1, -2, -1, -1, -2, -1, -1, -1,  0, -1, -3, -2, -2, -1, -1, -6}, // X
    {-6, -6, -6, -6, -6, -6, -6, -6, -6, -6, -6, -6, -6, -6, -6, -6, -6, -6, -6, -6, -6, -6, -6,  1}  // *
}};

/// @brief BLOSUM45 substitution matrix
/// Less stringent matrix for distantly related sequences (<45% identity)
constexpr std::array<std::array<int, 24>, 24> blosum45 = {{
    //A   C   D   E   F   G   H   I   K   L   M   N   P   Q   R   S   T   V   W   Y   B   Z   X   *
    { 5, -1, -2, -1, -2,  0, -2, -1, -1, -1, -1, -1, -1, -1, -2,  1,  0,  0, -2, -2, -1, -1,  0, -5}, // A
    {-1, 12, -3, -3, -2, -3, -3, -3, -3, -2, -2, -2, -4, -3, -4, -1, -1, -1, -5, -3, -3, -3, -2, -5}, // C
    {-2, -3,  7,  2, -4, -1,  0, -4,  0, -4, -3,  2, -1,  0, -1,  0, -1, -3, -4, -2,  5,  1, -1, -5}, // D
    {-1, -3,  2,  6, -3, -2,  0, -3,  1, -2, -2,  0, -1,  2,  0,  0, -1, -3, -3, -2,  1,  4, -1, -5}, // E
    {-2, -2, -4, -3,  8, -3, -2,  0, -3,  1,  0, -2, -3, -4, -2, -2, -1, -1,  1,  3, -3, -3, -1, -5}, // F
    { 0, -3, -1, -2, -3,  7, -2, -4, -2, -4, -2,  0, -2, -2, -2,  0, -2, -3, -2, -3, -1, -2, -1, -5}, // G
    {-2, -3,  0,  0, -2, -2, 10, -3, -1, -2, -2,  1, -2,  1,  0, -1, -2, -3, -3,  2,  0,  0, -1, -5}, // H
    {-1, -3, -4, -3,  0, -4, -3,  5, -3,  2,  2, -3, -2, -2, -3, -2, -1,  3, -2,  0, -3, -3, -1, -5}, // I
    {-1, -3,  0,  1, -3, -2, -1, -3,  5, -3, -1,  0, -1,  1,  2,  0, -1, -2, -2, -1,  0,  1, -1, -5}, // K
    {-1, -2, -4, -2,  1, -4, -2,  2, -3,  5,  2, -3, -3, -1, -3, -3, -1,  1, -2,  0, -3, -2, -1, -5}, // L
    {-1, -2, -3, -2,  0, -2, -2,  2, -1,  2,  6, -2, -2,  0, -2, -2, -1,  1, -2,  0, -3, -1, -1, -5}, // M
    {-1, -2,  2,  0, -2,  0,  1, -3,  0, -3, -2,  6, -2,  0,  0,  1,  0, -3, -4, -2,  4,  0, -1, -5}, // N
    {-1, -4, -1, -1, -3, -2, -2, -2, -1, -3, -2, -2,  9, -1, -2, -1, -1, -3, -3, -3, -2, -1, -2, -5}, // P
    {-1, -3,  0,  2, -4, -2,  1, -2,  1, -1,  0,  0, -1,  6,  1,  0, -1, -3, -2, -1,  0,  3, -1, -5}, // Q
    {-2, -4, -1,  0, -2, -2,  0, -3,  2, -3, -2,  0, -2,  1,  7, -1, -1, -2, -2, -1, -1,  0, -1, -5}, // R
    { 1, -1,  0,  0, -2,  0, -1, -2,  0, -3, -2,  1, -1,  0, -1,  4,  2, -1, -4, -2,  0,  0,  0, -5}, // S
    { 0, -1, -1, -1, -1, -2, -2, -1, -1, -1, -1,  0, -1, -1, -1,  2,  5,  0, -3, -1,  0, -1,  0, -5}, // T
    { 0, -1, -3, -3, -1, -3, -3,  3, -2,  1,  1, -3, -3, -3, -2, -1,  0,  5, -3, -1, -3, -3, -1, -5}, // V
    {-2, -5, -4, -3,  1, -2, -3, -2, -2, -2, -2, -4, -3, -2, -2, -4, -3, -3, 15,  3, -4, -2, -2, -5}, // W
    {-2, -3, -2, -2,  3, -3,  2,  0, -1,  0,  0, -2, -3, -1, -1, -2, -1, -1,  3,  8, -2, -2, -1, -5}, // Y
    {-1, -3,  5,  1, -3, -1,  0, -3,  0, -3, -3,  4, -2,  0, -1,  0,  0, -3, -4, -2,  5,  2, -1, -5}, // B
    {-1, -3,  1,  4, -3, -2,  0, -3,  1, -2, -1,  0, -1,  3,  0,  0, -1, -3, -2, -2,  2,  4, -1, -5}, // Z
    { 0, -2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -2, -1, -1,  0,  0, -1, -2, -1, -1, -1, -1, -5}, // X
    {-5, -5, -5, -5, -5, -5, -5, -5, -5, -5, -5, -5, -5, -5, -5, -5, -5, -5, -5, -5, -5, -5, -5,  1}  // *
}};

} // namespace gnx::lut
